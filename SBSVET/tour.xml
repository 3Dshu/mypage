<!-- Made by KPGui, homepage: www.kpgui.com -->
<krpano >
    
    <plugin name="scrollstage" url="%CURRENTXML%/002.jpg" keep="false" align="center" edge="center" x="0" y="0" width="500" height="300" maskchildren="true" />

    <plugin name="imagestage" parent="scrollstage" url="%CURRENTXML%/Desert.jpg" keep="false" align="lefttop" edge="lefttop" x="0" y="0" ox="10" oy="10" width="1470" height="280" maskchildren="true" onloaded="loadstyle(_Dragable_);makedragable();set(plugin[imagestage].leftx,-490);set(plugin[imagestage].rightx,490);" />

    <plugin name="image1" parent="imagestage" url="%CURRENTXML%/Hydrangeas.jpg" keep="false" align="lefttop" edge="lefttop" x="0" y="0" width="480" height="280" capture="false" maskchildren="true" />

    <plugin name="image2" parent="imagestage" url="%CURRENTXML%/Jellyfish.jpg" keep="false" align="lefttop" edge="lefttop" x="490" y="0" width="480" height="280" capture="false" maskchildren="true" />

    <plugin name="image3" parent="imagestage" url="%CURRENTXML%/Penguins.jpg" keep="false" align="lefttop" edge="lefttop" x="980" y="0" width="480" height="280" capture="false" maskchildren="true" />

    <style name="_Dragable_" dragX="true" dragY="false" fixLimits="false" dragLimitsX="true" dragXmin="0" dragXmax="0" dragLimitsY="false" dragYmin="0" dragYmax="0" onDragStart="" onDragEnd="" onDrag="" onGestureDown="" onGestureUp="" onGestureLeft="if(dragXmin GT leftx,	if(leftx GT -1470, 		movestage(-490); 	););" onGestureRight="if(dragXmin GT leftx,	if(rightx LT 490, 		movestage(490); 	););" dragInertia="3" gestLimPos="30" gestLimNeg="-30" gestLimLow="20" makeDragable="ifnot(dragable,	set(plugin[get(name)].old_mouse_x,0); 	set(plugin[get(name)].old_mouse_y,0);	set(plugin[get(name)].dragSpeedX,0);	set(plugin[get(name)].dragSpeedY,0);	set(plugin[get(name)].olddx,0);	set(plugin[get(name)].olddy,0);	set(plugin[get(name)].drag,false);	set(plugin[get(name)].moved,false);	set(plugin[get(name)].centerx,0);	set(plugin[get(name)].centery,0);	set(plugin[get(name)].drag_adjustx,0);	set(plugin[get(name)].drag_adjusty,0);	set(plugin[get(name)].dx,0);	set(plugin[get(name)].dy,0);	set(plugin[get(name)].dh,0);	set(plugin[get(name)].dv,0);	set(plugin[get(name)].delay_div,0);	set(plugin[get(name)].fps_delay,0.015);    set(plugin[get(name)].html5_delay,0.030);	set(plugin[get(name)].onDragging_runing,false);		txtadd(plugin[get(name)].ondown,dragOnDown(););	ifnot(isflash,copy(plugin[get(name)].fps_delay,plugin[get(name)].html5_delay););	indexoftxt(plugin[get(name)].has_right,get(plugin[get(name)].align),right);	indexoftxt(plugin[get(name)].has_bottom,get(plugin[get(name)].align),bottom);	set(plugin[get(name)].dragable,true););" dragOnDown="if(dragable,	set(moved,true); set(drag,true);	stoptween(x); stoptween(y); stoptween(ath); stoptween(atv);	copy(old_mouse_x,mouse.x); copy(old_mouse_y,mouse.y); 	copy(centerx,x);copy(centery,y);set(delay_div,400);	if(has_right GT -1,sub(mx,stagewidth,mouse.x);sub(drag_adjustx,mx,centerx);,sub(drag_adjustx,mouse.x,centerx););	if(has_bottom GT -1,sub(my,stageheight,mouse.y);sub(drag_adjusty,my,centery);,sub(drag_adjusty,mouse.y,centery););	ifnot(onDragging_runing,onDragging();onDragStart(););	Dragging(););" dragOnUp="sub(dragSpeedX,dx,olddx);mul(dragSpeedX,dragInertia);sub(dragSpeedY,dy,olddy);mul(dragSpeedY,dragInertia);        add(dx,dragSpeedX); add(dy,dragSpeedY); div(dt_delayX,dragSpeedX,delay_div); Math.abs(dt_delayX);div(dt_delayY,dragSpeedY,delay_div); Math.abs(dt_delayY);if(dt_delayX GT dt_delayY, copy(dt_delayY,dt_delayX););if(dt_delayY GT 1.8, set(dt_delayY,1.8); );            dragCheckLimits();            if(dragInertia GT 0,	if(dragX,		stoptween(x); tween(x,get(dx),get(dt_delayY),easeOutQuad,onDrag();if(drag,onDragEnd());set(drag,false););	);	if(dragY,		stoptween(y); tween(y,get(dy),get(dt_delayY),easeOutQuad,onDrag();if(drag,onDragEnd());set(drag,false););	););gestureOnUp();" gestureOnUp="sub(temp_dx,old_mouse_x,mouse.x); sub(temp_dy,old_mouse_y,mouse.y); copy(temp_dx_abs,temp_dx); Math.abs(temp_dx_abs); copy(temp_dy_abs,temp_dy); Math.abs(temp_dy_abs);if(temp_dx_abs LT gestLimLow,	if(temp_dy LT gestLimNeg,if(onGestureDown !== null,onGestureDown();););	if(temp_dy GT gestLimPos,if(onGestureUp !== null,onGestureUp(););););if(temp_dy_abs LT gestLimLow,	if(temp_dx GT gestLimPos,if(onGestureLeft !== null,onGestureLeft();););	if(temp_dx LT gestLimNeg,if(onGestureRight !== null,onGestureRight(););););" Dragging="if(pressed, 	copy(olddx,dx);copy(olddy,dy);	if(has_right GT -1, sub(mx,stagewidth,mouse.x);,copy(mx,mouse.x); );	if(has_bottom GT -1, sub(my,stageheight,mouse.y);,copy(my,mouse.y); );	sub(dx,mx,drag_adjustx); 	sub(dy,my,drag_adjusty);	if(fixLimits, dragCheckLimits(););	if(dragX,copy(x,dx);); if(dragY,copy(y,dy););	delayedcall(get(fps_delay),Dragging(););	set(moved,true);if(mouse.x == old_mouse_x, if(mouse.y == old_mouse_y, set(moved,false);););,	dragOnUp(););" onDragging="if(drag, onDrag();set(onDragging_runing,true);delayedcall(get(fps_delay),set(onDragging_runing,false);onDragging();););" dragCheckLimits="if(dragLimitsY,	if(dy LT dragYmin, copy(dy,dragYmin); set(dt_delayY,0.3); ); 	if(dy GT dragYmax, copy(dy,dragYmax); set(dt_delayY,0.3); ););if(dragLimitsX,	if(dx LT dragXmin,  copy(dx,dragXmin); set(dt_delayY,0.3); ); 	if(dx GT dragXmax,  copy(dx,dragXmax); set(dt_delayY,0.3); ););" />

    <action name="movestage" >        
        stoptween(plugin[imagestage].x);
        add(plugin[imagestage].dragXmin,%1);
        add(plugin[imagestage].dragXmax,%1);
        add(plugin[imagestage].leftx,%1);
        add(plugin[imagestage].rightx,%1);
        set(plugin[imagestage].enabled,false);
        tween(plugin[imagestage].x,get(plugin[imagestage].dragXmax),,,set(plugin[imagestage].enabled,true););
    </action>

    <plugin name="newplugin" parent="scrollstage" url="%CURRENTXML%/arrow.jpg" keep="false" align="left" edge="left" x="0" y="0" zorder="100" onclick="if(plugin[imagestage].rightx LT 490, 	movestage(490); );" />

    <plugin name="newplugin1" parent="scrollstage" url="%CURRENTXML%/arrow.jpg" keep="false" rotate="180" align="right" edge="left" x="0" y="0" zorder="100" onclick="if(plugin[imagestage].leftx GT -1470, 	movestage(-490); );" />

</krpano>
